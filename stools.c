#include "stools.h"
#include <time.h>
#include <math.h> 
#define N 1000
#define RAND_MAX 2147483647

double *createVector(int dim)
{
double *pf;
	if((pf=(double *)malloc(dim*sizeof(double)))==NULL)
	{printf("Error allocating memory \n");
	exit(1);
	}

return pf;
}

int *createIntVector(int dim)
{
int *pf;
	if((pf=(int *)malloc(dim*sizeof(int)))==NULL)
	{printf("Error allocating memory \n");
	exit(1);
	}

return pf;
}

int **createVectorList(int n, int m)
{
int **array;
int i;
if((array=(int **)malloc(n*sizeof(int*)))==NULL)
	{printf("Error allocating memory \n");
	exit(1);
	}
	for(i=0;i<n;i++)
	array[i]=createIntVector(m);
	return array;
}

void loadVector(int dim,double *array,char *fileName)
{
int i;
FILE *f=fopen(fileName, "r");
	if(f==NULL){
    	printf("Error opening x0.\n");
    	exit(1);}
for(i=0;i<dim;i++)
if(fscanf(f,"%le",&array[i])<=0)
	{printf("Error allocating memory \n");
	exit(1);
	}
}

int **loadMut(int g, int index, int M)
{
char fileName[28];
int i,j;
int **mut;
FILE *input;

mut=createVectorList(g+M,3);

sprintf(fileName,"mut_%d.dat",index);
if((input=fopen(fileName,"r"))==NULL)
	{
	printf("Cannot open file %s\n",fileName);
	exit(1);
	}

for(j=0;j<g+M;j++)
	for(i=0;i<3;i++)
	if(fscanf(input,"%d",&mut[j][i]) !=1)
	printf("Error in mut file.\n");

return mut;
}

void exportVector(double *array, char *fileName)
{
int i;
double *var,*val,total,avg;
FILE *f=fopen(fileName, "w");
	if(f==NULL){
    printf("Error writing file!\n");
    exit(1);}

var=createVector(N);
val=createVector(N);

srand(time(NULL));

for(i=0;i<N;i++)
	var[i]=rand()%100; //Range of variation
	
for(i=0;i<N;i++)
	{
	val[i]=array[i]+var[i]*pow(10,-6); //Max Variation
	total+=val[i];
	}
	
for(i=0;i<N;i++)
	fprintf(f,"%le\n",val[i]/total);
	
}

double sumR(double *x,int gen, int m, int **mut)
{
//(x,gen,m,mut)
int i,D,nut;
double value,xout;
double *ri;
value=0;

//D=4;
//xout=.2;
//nut=4;

ri=createVector(N);
ri=Ri(x,N,gen,m,mut);

for(i=0;i<N;i++)
	value+=ri[i];

//for(i=0;i<nut;i++)
//	value+=D*x[i+nut]*(xout-x[i]);

return value;	
}


double ris(double *x,int gen, int m, int **mut)
{
double value,xout;
double *ri;
value=0;

ri=createVector(N);
ri=Ri(x,N,gen,m,mut);

printf("%0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf %0.13lf \n", ri[0]/x[0],ri[1]/x[1],ri[2]/x[2],ri[3]/x[3],ri[4]/x[4],ri[5]/x[5],ri[6]/x[6],ri[7]/x[7],ri[8]/x[8],ri[9]/x[9],ri[10]/x[10],ri[11]/x[11],ri[12]/x[12],ri[13]/x[13],ri[14]/x[14],ri[15]/x[15],ri[16]/x[16],ri[17]/x[17],ri[18]/x[18],ri[19]/x[19],ri[20]/x[20],ri[21]/x[21],ri[22]/x[22],ri[23]/x[23],ri[24]/x[24],ri[25]/x[25],ri[26]/x[26],ri[27]/x[27],ri[28]/x[28],ri[29]/x[29],ri[30]/x[30],ri[31]/x[31],ri[32]/x[32],ri[33]/x[33],ri[34]/x[34],ri[35]/x[35],ri[36]/x[36],ri[37]/x[37],ri[38]/x[38],ri[39]/x[39],ri[40]/x[40],ri[41]/x[41],ri[42]/x[42],ri[43]/x[43],ri[44]/x[44],ri[45]/x[45],ri[46]/x[46],ri[47]/x[47],ri[48]/x[48],ri[49]/x[49],ri[50]/x[50],ri[51]/x[51],ri[52]/x[52],ri[53]/x[53],ri[54]/x[54],ri[55]/x[55],ri[56]/x[56],ri[57]/x[57],ri[58]/x[58],ri[59]/x[59],ri[60]/x[60],ri[61]/x[61],ri[62]/x[62],ri[63]/x[63],ri[64]/x[64],ri[65]/x[65],ri[66]/x[66],ri[67]/x[67],ri[68]/x[68],ri[69]/x[69],ri[70]/x[70],ri[71]/x[71],ri[72]/x[72],ri[73]/x[73],ri[74]/x[74],ri[75]/x[75],ri[76]/x[76],ri[77]/x[77],ri[78]/x[78],ri[79]/x[79],ri[80]/x[80],ri[81]/x[81],ri[82]/x[82],ri[83]/x[83],ri[84]/x[84],ri[85]/x[85],ri[86]/x[86],ri[87]/x[87],ri[88]/x[88],ri[89]/x[89],ri[90]/x[90],ri[91]/x[91],ri[92]/x[92],ri[93]/x[93],ri[94]/x[94],ri[95]/x[95],ri[96]/x[96],ri[97]/x[97],ri[98]/x[98],ri[99]/x[99],ri[100]/x[100],ri[101]/x[101],ri[102]/x[102],ri[103]/x[103],ri[104]/x[104],ri[105]/x[105],ri[106]/x[106],ri[107]/x[107],ri[108]/x[108],ri[109]/x[109],ri[110]/x[110],ri[111]/x[111],ri[112]/x[112],ri[113]/x[113],ri[114]/x[114],ri[115]/x[115],ri[116]/x[116],ri[117]/x[117],ri[118]/x[118],ri[119]/x[119],ri[120]/x[120],ri[121]/x[121],ri[122]/x[122],ri[123]/x[123],ri[124]/x[124],ri[125]/x[125],ri[126]/x[126],ri[127]/x[127],ri[128]/x[128],ri[129]/x[129],ri[130]/x[130],ri[131]/x[131],ri[132]/x[132],ri[133]/x[133],ri[134]/x[134],ri[135]/x[135],ri[136]/x[136],ri[137]/x[137],ri[138]/x[138],ri[139]/x[139],ri[140]/x[140],ri[141]/x[141],ri[142]/x[142],ri[143]/x[143],ri[144]/x[144],ri[145]/x[145],ri[146]/x[146],ri[147]/x[147],ri[148]/x[148],ri[149]/x[149],ri[150]/x[150],ri[151]/x[151],ri[152]/x[152],ri[153]/x[153],ri[154]/x[154],ri[155]/x[155],ri[156]/x[156],ri[157]/x[157],ri[158]/x[158],ri[159]/x[159],ri[160]/x[160],ri[161]/x[161],ri[162]/x[162],ri[163]/x[163],ri[164]/x[164],ri[165]/x[165],ri[166]/x[166],ri[167]/x[167],ri[168]/x[168],ri[169]/x[169],ri[170]/x[170],ri[171]/x[171],ri[172]/x[172],ri[173]/x[173],ri[174]/x[174],ri[175]/x[175],ri[176]/x[176],ri[177]/x[177],ri[178]/x[178],ri[179]/x[179],ri[180]/x[180],ri[181]/x[181],ri[182]/x[182],ri[183]/x[183],ri[184]/x[184],ri[185]/x[185],ri[186]/x[186],ri[187]/x[187],ri[188]/x[188],ri[189]/x[189],ri[190]/x[190],ri[191]/x[191],ri[192]/x[192],ri[193]/x[193],ri[194]/x[194],ri[195]/x[195],ri[196]/x[196],ri[197]/x[197],ri[198]/x[198],ri[199]/x[199],ri[200]/x[200],ri[201]/x[201],ri[202]/x[202],ri[203]/x[203],ri[204]/x[204],ri[205]/x[205],ri[206]/x[206],ri[207]/x[207],ri[208]/x[208],ri[209]/x[209],ri[210]/x[210],ri[211]/x[211],ri[212]/x[212],ri[213]/x[213],ri[214]/x[214],ri[215]/x[215],ri[216]/x[216],ri[217]/x[217],ri[218]/x[218],ri[219]/x[219],ri[220]/x[220],ri[221]/x[221],ri[222]/x[222],ri[223]/x[223],ri[224]/x[224],ri[225]/x[225],ri[226]/x[226],ri[227]/x[227],ri[228]/x[228],ri[229]/x[229],ri[230]/x[230],ri[231]/x[231],ri[232]/x[232],ri[233]/x[233],ri[234]/x[234],ri[235]/x[235],ri[236]/x[236],ri[237]/x[237],ri[238]/x[238],ri[239]/x[239],ri[240]/x[240],ri[241]/x[241],ri[242]/x[242],ri[243]/x[243],ri[244]/x[244],ri[245]/x[245],ri[246]/x[246],ri[247]/x[247],ri[248]/x[248],ri[249]/x[249], ri[250]/x[250],ri[251]/x[251],ri[252]/x[252],ri[253]/x[253],ri[254]/x[254],ri[255]/x[255],ri[256]/x[256],ri[257]/x[257],ri[258]/x[258],ri[259]/x[259],ri[260]/x[260],ri[261]/x[261],ri[262]/x[262],ri[263]/x[263],ri[264]/x[264],ri[265]/x[265],ri[266]/x[266],ri[267]/x[267],ri[268]/x[268],ri[269]/x[269],ri[270]/x[270],ri[271]/x[271],ri[272]/x[272],ri[273]/x[273],ri[274]/x[274],ri[275]/x[275],ri[276]/x[276],ri[277]/x[277],ri[278]/x[278],ri[279]/x[279],ri[280]/x[280],ri[281]/x[281],ri[282]/x[282],ri[283]/x[283],ri[284]/x[284],ri[285]/x[285],ri[286]/x[286],ri[287]/x[287],ri[288]/x[288],ri[289]/x[289],ri[290]/x[290],ri[291]/x[291],ri[292]/x[292],ri[293]/x[293],ri[294]/x[294],ri[295]/x[295],ri[296]/x[296],ri[297]/x[297],ri[298]/x[298],ri[299]/x[299],ri[300]/x[300],ri[301]/x[301],ri[302]/x[302],ri[303]/x[303],ri[304]/x[304],ri[305]/x[305],ri[306]/x[306],ri[307]/x[307],ri[308]/x[308],ri[309]/x[309],ri[310]/x[310],ri[311]/x[311],ri[312]/x[312],ri[313]/x[313],ri[314]/x[314],ri[315]/x[315],ri[316]/x[316],ri[317]/x[317],ri[318]/x[318],ri[319]/x[319],ri[320]/x[320],ri[321]/x[321],ri[322]/x[322],ri[323]/x[323],ri[324]/x[324],ri[325]/x[325],ri[326]/x[326],ri[327]/x[327],ri[328]/x[328],ri[329]/x[329],ri[330]/x[330],ri[331]/x[331],ri[332]/x[332],ri[333]/x[333],ri[334]/x[334],ri[335]/x[335],ri[336]/x[336],ri[337]/x[337],ri[338]/x[338],ri[339]/x[339],ri[340]/x[340],ri[341]/x[341],ri[342]/x[342],ri[343]/x[343],ri[344]/x[344],ri[345]/x[345],ri[346]/x[346],ri[347]/x[347],ri[348]/x[348],ri[349]/x[349],ri[350]/x[350],ri[351]/x[351],ri[352]/x[352],ri[353]/x[353],ri[354]/x[354],ri[355]/x[355],ri[356]/x[356],ri[357]/x[357],ri[358]/x[358],ri[359]/x[359],ri[360]/x[360],ri[361]/x[361],ri[362]/x[362],ri[363]/x[363],ri[364]/x[364],ri[365]/x[365],ri[366]/x[366],ri[367]/x[367],ri[368]/x[368],ri[369]/x[369],ri[370]/x[370],ri[371]/x[371],ri[372]/x[372],ri[373]/x[373],ri[374]/x[374],ri[375]/x[375],ri[376]/x[376],ri[377]/x[377],ri[378]/x[378],ri[379]/x[379],ri[380]/x[380],ri[381]/x[381],ri[382]/x[382],ri[383]/x[383],ri[384]/x[384],ri[385]/x[385],ri[386]/x[386],ri[387]/x[387],ri[388]/x[388],ri[389]/x[389],ri[390]/x[390],ri[391]/x[391],ri[392]/x[392],ri[393]/x[393],ri[394]/x[394],ri[395]/x[395],ri[396]/x[396],ri[397]/x[397],ri[398]/x[398],ri[399]/x[399],ri[400]/x[400],ri[401]/x[401],ri[402]/x[402],ri[403]/x[403],ri[404]/x[404],ri[405]/x[405],ri[406]/x[406],ri[407]/x[407],ri[408]/x[408],ri[409]/x[409],ri[410]/x[410],ri[411]/x[411],ri[412]/x[412],ri[413]/x[413],ri[414]/x[414],ri[415]/x[415],ri[416]/x[416],ri[417]/x[417],ri[418]/x[418],ri[419]/x[419],ri[420]/x[420],ri[421]/x[421],ri[422]/x[422],ri[423]/x[423],ri[424]/x[424],ri[425]/x[425],ri[426]/x[426],ri[427]/x[427],ri[428]/x[428],ri[429]/x[429],ri[430]/x[430],ri[431]/x[431],ri[432]/x[432],ri[433]/x[433],ri[434]/x[434],ri[435]/x[435],ri[436]/x[436],ri[437]/x[437],ri[438]/x[438],ri[439]/x[439],ri[440]/x[440],ri[441]/x[441],ri[442]/x[442],ri[443]/x[443],ri[444]/x[444],ri[445]/x[445],ri[446]/x[446],ri[447]/x[447],ri[448]/x[448],ri[449]/x[449],ri[450]/x[450],ri[451]/x[451],ri[452]/x[452],ri[453]/x[453],ri[454]/x[454],ri[455]/x[455],ri[456]/x[456],ri[457]/x[457],ri[458]/x[458],ri[459]/x[459],ri[460]/x[460],ri[461]/x[461],ri[462]/x[462],ri[463]/x[463],ri[464]/x[464],ri[465]/x[465],ri[466]/x[466],ri[467]/x[467],ri[468]/x[468],ri[469]/x[469],ri[470]/x[470],ri[471]/x[471],ri[472]/x[472],ri[473]/x[473],ri[474]/x[474],ri[475]/x[475],ri[476]/x[476],ri[477]/x[477],ri[478]/x[478],ri[479]/x[479],ri[480]/x[480],ri[481]/x[481],ri[482]/x[482],ri[483]/x[483],ri[484]/x[484],ri[485]/x[485],ri[486]/x[486],ri[487]/x[487],ri[488]/x[488],ri[489]/x[489],ri[490]/x[490],ri[491]/x[491],ri[492]/x[492],ri[493]/x[493],ri[494]/x[494],ri[495]/x[495],ri[496]/x[496],ri[497]/x[497],ri[498]/x[498],ri[499]/x[499], ri[500]/x[500],ri[501]/x[501],ri[502]/x[502],ri[503]/x[503],ri[504]/x[504],ri[505]/x[505],ri[506]/x[506],ri[507]/x[507],ri[508]/x[508],ri[509]/x[509],ri[510]/x[510],ri[511]/x[511],ri[512]/x[512],ri[513]/x[513],ri[514]/x[514],ri[515]/x[515],ri[516]/x[516],ri[517]/x[517],ri[518]/x[518],ri[519]/x[519],ri[520]/x[520],ri[521]/x[521],ri[522]/x[522],ri[523]/x[523],ri[524]/x[524],ri[525]/x[525],ri[526]/x[526],ri[527]/x[527],ri[528]/x[528],ri[529]/x[529],ri[530]/x[530],ri[531]/x[531],ri[532]/x[532],ri[533]/x[533],ri[534]/x[534],ri[535]/x[535],ri[536]/x[536],ri[537]/x[537],ri[538]/x[538],ri[539]/x[539],ri[540]/x[540],ri[541]/x[541],ri[542]/x[542],ri[543]/x[543],ri[544]/x[544],ri[545]/x[545],ri[546]/x[546],ri[547]/x[547],ri[548]/x[548],ri[549]/x[549],ri[550]/x[550],ri[551]/x[551],ri[552]/x[552],ri[553]/x[553],ri[554]/x[554],ri[555]/x[555],ri[556]/x[556],ri[557]/x[557],ri[558]/x[558],ri[559]/x[559],ri[560]/x[560],ri[561]/x[561],ri[562]/x[562],ri[563]/x[563],ri[564]/x[564],ri[565]/x[565],ri[566]/x[566],ri[567]/x[567],ri[568]/x[568],ri[569]/x[569],ri[570]/x[570],ri[571]/x[571],ri[572]/x[572],ri[573]/x[573],ri[574]/x[574],ri[575]/x[575],ri[576]/x[576],ri[577]/x[577],ri[578]/x[578],ri[579]/x[579],ri[580]/x[580],ri[581]/x[581],ri[582]/x[582],ri[583]/x[583],ri[584]/x[584],ri[585]/x[585],ri[586]/x[586],ri[587]/x[587],ri[588]/x[588],ri[589]/x[589],ri[590]/x[590],ri[591]/x[591],ri[592]/x[592],ri[593]/x[593],ri[594]/x[594],ri[595]/x[595],ri[596]/x[596],ri[597]/x[597],ri[598]/x[598],ri[599]/x[599],ri[600]/x[600],ri[601]/x[601],ri[602]/x[602],ri[603]/x[603],ri[604]/x[604],ri[605]/x[605],ri[606]/x[606],ri[607]/x[607],ri[608]/x[608],ri[609]/x[609],ri[610]/x[610],ri[611]/x[611],ri[612]/x[612],ri[613]/x[613],ri[614]/x[614],ri[615]/x[615],ri[616]/x[616],ri[617]/x[617],ri[618]/x[618],ri[619]/x[619],ri[620]/x[620],ri[621]/x[621],ri[622]/x[622],ri[623]/x[623],ri[624]/x[624],ri[625]/x[625],ri[626]/x[626],ri[627]/x[627],ri[628]/x[628],ri[629]/x[629],ri[630]/x[630],ri[631]/x[631],ri[632]/x[632],ri[633]/x[633],ri[634]/x[634],ri[635]/x[635],ri[636]/x[636],ri[637]/x[637],ri[638]/x[638],ri[639]/x[639],ri[640]/x[640],ri[641]/x[641],ri[642]/x[642],ri[643]/x[643],ri[644]/x[644],ri[645]/x[645],ri[646]/x[646],ri[647]/x[647],ri[648]/x[648],ri[649]/x[649],ri[650]/x[650],ri[651]/x[651],ri[652]/x[652],ri[653]/x[653],ri[654]/x[654],ri[655]/x[655],ri[656]/x[656],ri[657]/x[657],ri[658]/x[658],ri[659]/x[659],ri[660]/x[660],ri[661]/x[661],ri[662]/x[662],ri[663]/x[663],ri[664]/x[664],ri[665]/x[665],ri[666]/x[666],ri[667]/x[667],ri[668]/x[668],ri[669]/x[669],ri[670]/x[670],ri[671]/x[671],ri[672]/x[672],ri[673]/x[673],ri[674]/x[674],ri[675]/x[675],ri[676]/x[676],ri[677]/x[677],ri[678]/x[678],ri[679]/x[679],ri[680]/x[680],ri[681]/x[681],ri[682]/x[682],ri[683]/x[683],ri[684]/x[684],ri[685]/x[685],ri[686]/x[686],ri[687]/x[687],ri[688]/x[688],ri[689]/x[689],ri[690]/x[690],ri[691]/x[691],ri[692]/x[692],ri[693]/x[693],ri[694]/x[694],ri[695]/x[695],ri[696]/x[696],ri[697]/x[697],ri[698]/x[698],ri[699]/x[699],ri[700]/x[700],ri[701]/x[701],ri[702]/x[702],ri[703]/x[703],ri[704]/x[704],ri[705]/x[705],ri[706]/x[706],ri[707]/x[707],ri[708]/x[708],ri[709]/x[709],ri[710]/x[710],ri[711]/x[711],ri[712]/x[712],ri[713]/x[713],ri[714]/x[714],ri[715]/x[715],ri[716]/x[716],ri[717]/x[717],ri[718]/x[718],ri[719]/x[719],ri[720]/x[720],ri[721]/x[721],ri[722]/x[722],ri[723]/x[723],ri[724]/x[724],ri[725]/x[725],ri[726]/x[726],ri[727]/x[727],ri[728]/x[728],ri[729]/x[729],ri[730]/x[730],ri[731]/x[731],ri[732]/x[732],ri[733]/x[733],ri[734]/x[734],ri[735]/x[735],ri[736]/x[736],ri[737]/x[737],ri[738]/x[738],ri[739]/x[739],ri[740]/x[740],ri[741]/x[741],ri[742]/x[742],ri[743]/x[743],ri[744]/x[744],ri[745]/x[745],ri[746]/x[746],ri[747]/x[747],ri[748]/x[748],ri[749]/x[749],ri[750]/x[750],ri[751]/x[751],ri[752]/x[752],ri[753]/x[753],ri[754]/x[754],ri[755]/x[755],ri[756]/x[756],ri[757]/x[757],ri[758]/x[758],ri[759]/x[759],ri[760]/x[760],ri[761]/x[761],ri[762]/x[762],ri[763]/x[763],ri[764]/x[764],ri[765]/x[765],ri[766]/x[766],ri[767]/x[767],ri[768]/x[768],ri[769]/x[769],ri[770]/x[770],ri[771]/x[771],ri[772]/x[772],ri[773]/x[773],ri[774]/x[774],ri[775]/x[775],ri[776]/x[776],ri[777]/x[777],ri[778]/x[778],ri[779]/x[779],ri[780]/x[780],ri[781]/x[781],ri[782]/x[782],ri[783]/x[783],ri[784]/x[784],ri[785]/x[785],ri[786]/x[786],ri[787]/x[787],ri[788]/x[788],ri[789]/x[789],ri[790]/x[790],ri[791]/x[791],ri[792]/x[792],ri[793]/x[793],ri[794]/x[794],ri[795]/x[795],ri[796]/x[796],ri[797]/x[797],ri[798]/x[798],ri[799]/x[799],ri[800]/x[800],ri[801]/x[801],ri[802]/x[802],ri[803]/x[803],ri[804]/x[804],ri[805]/x[805],ri[806]/x[806],ri[807]/x[807],ri[808]/x[808],ri[809]/x[809],ri[810]/x[810],ri[811]/x[811],ri[812]/x[812],ri[813]/x[813],ri[814]/x[814],ri[815]/x[815],ri[816]/x[816],ri[817]/x[817],ri[818]/x[818],ri[819]/x[819],ri[820]/x[820],ri[821]/x[821],ri[822]/x[822],ri[823]/x[823],ri[824]/x[824],ri[825]/x[825],ri[826]/x[826],ri[827]/x[827],ri[828]/x[828],ri[829]/x[829],ri[830]/x[830],ri[831]/x[831],ri[832]/x[832],ri[833]/x[833],ri[834]/x[834],ri[835]/x[835],ri[836]/x[836],ri[837]/x[837],ri[838]/x[838],ri[839]/x[839],ri[840]/x[840],ri[841]/x[841],ri[842]/x[842],ri[843]/x[843],ri[844]/x[844],ri[845]/x[845],ri[846]/x[846],ri[847]/x[847],ri[848]/x[848],ri[849]/x[849],ri[850]/x[850],ri[851]/x[851],ri[852]/x[852],ri[853]/x[853],ri[854]/x[854],ri[855]/x[855],ri[856]/x[856],ri[857]/x[857],ri[858]/x[858],ri[859]/x[859],ri[860]/x[860],ri[861]/x[861],ri[862]/x[862],ri[863]/x[863],ri[864]/x[864],ri[865]/x[865],ri[866]/x[866],ri[867]/x[867],ri[868]/x[868],ri[869]/x[869],ri[870]/x[870],ri[871]/x[871],ri[872]/x[872],ri[873]/x[873],ri[874]/x[874],ri[875]/x[875],ri[876]/x[876],ri[877]/x[877],ri[878]/x[878],ri[879]/x[879],ri[880]/x[880],ri[881]/x[881],ri[882]/x[882],ri[883]/x[883],ri[884]/x[884],ri[885]/x[885],ri[886]/x[886],ri[887]/x[887],ri[888]/x[888],ri[889]/x[889],ri[890]/x[890],ri[891]/x[891],ri[892]/x[892],ri[893]/x[893],ri[894]/x[894],ri[895]/x[895],ri[896]/x[896],ri[897]/x[897],ri[898]/x[898],ri[899]/x[899],ri[900]/x[900],ri[901]/x[901],ri[902]/x[902],ri[903]/x[903],ri[904]/x[904],ri[905]/x[905],ri[906]/x[906],ri[907]/x[907],ri[908]/x[908],ri[909]/x[909],ri[910]/x[910],ri[911]/x[911],ri[912]/x[912],ri[913]/x[913],ri[914]/x[914],ri[915]/x[915],ri[916]/x[916],ri[917]/x[917],ri[918]/x[918],ri[919]/x[919],ri[920]/x[920],ri[921]/x[921],ri[922]/x[922],ri[923]/x[923],ri[924]/x[924],ri[925]/x[925],ri[926]/x[926],ri[927]/x[927],ri[928]/x[928],ri[929]/x[929],ri[930]/x[930],ri[931]/x[931],ri[932]/x[932],ri[933]/x[933],ri[934]/x[934],ri[935]/x[935],ri[936]/x[936],ri[937]/x[937],ri[938]/x[938],ri[939]/x[939],ri[940]/x[940],ri[941]/x[941],ri[942]/x[942],ri[943]/x[943],ri[944]/x[944],ri[945]/x[945],ri[946]/x[946],ri[947]/x[947],ri[948]/x[948],ri[949]/x[949],ri[950]/x[950],ri[951]/x[951],ri[952]/x[952],ri[953]/x[953],ri[954]/x[954],ri[955]/x[955],ri[956]/x[956],ri[957]/x[957],ri[958]/x[958],ri[959]/x[959],ri[960]/x[960],ri[961]/x[961],ri[962]/x[962],ri[963]/x[963],ri[964]/x[964],ri[965]/x[965],ri[966]/x[966],ri[967]/x[967],ri[968]/x[968],ri[969]/x[969],ri[970]/x[970],ri[971]/x[971],ri[972]/x[972],ri[973]/x[973],ri[974]/x[974],ri[975]/x[975],ri[976]/x[976],ri[977]/x[977],ri[978]/x[978],ri[979]/x[979],ri[980]/x[980],ri[981]/x[981],ri[982]/x[982],ri[983]/x[983],ri[984]/x[984],ri[985]/x[985],ri[986]/x[986],ri[987]/x[987],ri[988]/x[988],ri[989]/x[989],ri[990]/x[990],ri[991]/x[991],ri[992]/x[992],ri[993]/x[993],ri[994]/x[994],ri[995]/x[995],ri[996]/x[996],ri[997]/x[997],ri[998]/x[998],ri[999]/x[999]);
}

double *xdot(double sumR, double *x,int gen, int m, int **mut)
{
//(sumR,x,gen,m,mut)
int i;
double *result,*ri;

ri=createVector(N);
ri=Ri(x,N,gen,m,mut);

for(i=0;i<N;i++)
	result[i]=ri[i]-x[i]*sumR;

return result;
}

void rk4(double sumR, double *x, double h, int gen, int m, int **mut)
{
//(sumR,x,h,gen,m,mut)
int i;
double t1[N],t2[N],t3[N];
double k1[N],k2[N],k3[N],k4[N];
double *xd;
xd=createVector(N);

xd=xdot(sumR,x,gen,m,mut);
for(i=0;i<N;i++)
t1[i]=x[i]+h/2*(k1[i]=xd[i]);

xd=xdot(sumR,t1,gen,m,mut);
for(i=0;i<N;i++)
t2[i]=x[i]+h/2*(k2[i]=xd[i]);

xd=xdot(sumR,t2,gen,m,mut);
for(i=0;i<N;i++)
t3[i]=x[i]+h*(k3[i]=xd[i]);

xd=xdot(sumR,t3,gen,m,mut);
for(i=0;i<N;i++)
k4[i]=xd[i];

for(i=0;i<N;i++)
x[i]+=(k1[i]+2*k2[i]+2*k3[i]+k4[i])*h/6;
}

double simpsonInt(double *f, int s, double h)
{
//(f,s,h)
int i;
if(s%2==0){printf("Error: s must be odd\n");exit(1);}
double integral,sumInt;
sumInt=f[0]+4*f[1];
for(i=1;i<s/2;i++)
sumInt+=2*f[i*2]+4*f[i*2+1];
sumInt+=f[s-1];
integral=(h/3)*sumInt;

return integral;
}

double addVol(double *f,double *x,int s,double h, int g, int i, int **mut)
{
//(f,x,s,h,g,i,mut)
int j;
double v;
v=0;

f[0]=sumR(x,g,i,mut);

for(j=1;j<s;j++)
	{
	rk4(f[j-1],x,h,g,i,mut);
	f[j]=sumR(x,g,i,mut);
	}

v=simpsonInt(f,s,h);

return v;
}
